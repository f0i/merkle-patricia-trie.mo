<!DOCTYPE html>
<html><head title="Doc"><meta charset="UTF-8"/><link href="styles.css" rel="stylesheet"/></head><body><nav class="sidebar"><h3>Modules</h3><ul><li><li><a href="Hash.html">Hash</a></li></li><li><li><a href="Key.html">Key</a></li></li><li><li><a href="Proof.html">Proof</a></li></li><li><li><a href="Trie.html">Trie</a></li></li><li><li><a href="Types.html">Types</a></li></li><li><li><a href="Value.html">Value</a></li></li><li><li><a href="util/ArrayExtra.html">util/ArrayExtra</a></li></li><li><li><a href="util/Hex.html">util/Hex</a></li></li><li><li><a href="util/IterExtra.html">util/IterExtra</a></li></li><li><li><a href="util/Keccak.html">util/Keccak</a></li></li><li><li><a href="util/Nibble.html">util/Nibble</a></li></li><li><li><a href="util/RLPHelper.html">util/RLPHelper</a></li></li><li><li><a href="util/lib.html">util/lib</a></li></li><li><li><a href="util/rlp/encode.html">util/rlp/encode</a></li></li></ul><h3>Declarations</h3><ul><li><li><a href="#type.Trie">Trie</a></li></li><li><li><a href="#type.Node">Node</a></li></li><li><li><a href="#type.PartialNode">PartialNode</a></li></li><li><li><a href="#type.Branch">Branch</a></li></li><li><li><a href="#type.Leaf">Leaf</a></li></li><li><li><a href="#type.Hash">Hash</a></li></li><li><li><a href="#type.Key">Key</a></li></li><li><li><a href="#init">init</a></li></li><li><li><a href="#nodeDecode">nodeDecode</a></li></li><li><li><a href="#delete">delete</a></li></li><li><li><a href="#deleteWithDB">deleteWithDB</a></li></li><li><li><a href="#put">put</a></li></li><li><li><a href="#createLeaf">createLeaf</a></li></li><li><li><a href="#get">get</a></li></li><li><li><a href="#getWithDB">getWithDB</a></li></li><li><li><a href="#nodeValue">nodeValue</a></li></li><li><li><a href="#nodeHash">nodeHash</a></li></li><li><li><a href="#nodeSerialize">nodeSerialize</a></li></li><li><li><a href="#rootHash">rootHash</a></li></li><li><li><a href="#hashHex">hashHex</a></li></li><li><li><a href="#type.Path">Path</a></li></li><li><li><a href="#findPath">findPath</a></li></li><li><li><a href="#findPathWithDB">findPathWithDB</a></li></li><li><li><a href="#toIter">toIter</a></li></li><li><li><a href="#isEmpty">isEmpty</a></li></li><li><li><a href="#nodeEqual">nodeEqual</a></li></li><li><li><a href="#equal">equal</a></li></li><li><li><a href="#nodeToText">nodeToText</a></li></li><li><li><a href="#pathToText">pathToText</a></li></li><li><li><a href="#valueToText">valueToText</a></li></li><li><li><a href="#type.DB">DB</a></li></li><li><li><a href="#putWithDB">putWithDB</a></li></li></ul></nav><div class="documentation"><h1>Trie</h1><div class="declaration"><h4 class="type-declaration" id="type.Trie"><span class="keyword">type </span><span class="type">Trie</span> = <a href="#type.Node"><span class="type">Node</span></a></h4><p></p></div><div class="declaration"><h4 class="type-declaration" id="type.Node"><span class="keyword">type </span><span class="type">Node</span> = {#nul; #branch : <a href="#type.Branch"><span class="type">Branch</span></a>; #leaf : <a href="#type.Leaf"><span class="type">Leaf</span></a>; #extension : <a href="#type.Extension"><span class="type">Extension</span></a>; #hash : <a href="#type.Hash"><span class="type">Hash</span></a>}</h4><p></p></div><div class="declaration"><h4 class="type-declaration" id="type.PartialNode"><span class="keyword">type </span><span class="type">PartialNode</span> = {#nul; #branch : <a href="#type.Branch"><span class="type">Branch</span></a>; #leaf : <a href="#type.Leaf"><span class="type">Leaf</span></a>; #extension : <a href="#type.Extension"><span class="type">Extension</span></a>}</h4><p></p></div><div class="declaration"><h4 class="type-declaration" id="type.Branch"><span class="keyword">type </span><span class="type">Branch</span> = { nodes : [<a href="#type.Node"><span class="type">Node</span></a>]; value : ?<a href="#type.Value"><span class="type">Value</span></a>; <span class="keyword">var </span>hash : ?<a href="#type.Hash"><span class="type">Hash</span></a> }</h4><p></p></div><div class="declaration"><h4 class="type-declaration" id="type.Leaf"><span class="keyword">type </span><span class="type">Leaf</span> = { key : <a href="#type.Key"><span class="type">Key</span></a>; value : <a href="#type.Value"><span class="type">Value</span></a>; <span class="keyword">var </span>hash : ?<a href="#type.Hash"><span class="type">Hash</span></a> }</h4><p></p></div><div class="declaration"><h4 class="type-declaration" id="type.Hash"><span class="keyword">type </span><span class="type">Hash</span> = <a href="Hash.html#type.Hash"><span class="type">Hash.Hash</span></a></h4><p></p></div><div class="declaration"><h4 class="type-declaration" id="type.Key"><span class="keyword">type </span><span class="type">Key</span> = <a href="Key.html#type.Key"><span class="type">Key.Key</span></a></h4><p><p>Key describing a path in the trie
In the case of ethereum this is keccak256(rlp(value))</p>
</p></div><div class="declaration"><h4 class="function" id="init"><code><span class="keyword">public func </span><span class="fnname">init</span>() : <a href="#type.Trie"><span class="type">Trie</span></a></code></h4><p><p>Create an empty trie</p>
</p></div><div class="declaration"><h4 class="function" id="nodeDecode"><code><span class="keyword">public func </span><span class="fnname">nodeDecode</span>(<span class="parameter">rlpData</span> : [<span class="type">Nat8</span>]) : <a href="#type.Node"><span class="type">Node</span></a></code></h4><p><p>Deserialize RLP encoded node</p>
</p></div><div class="declaration"><h4 class="function" id="delete"><code><span class="keyword">public func </span><span class="fnname">delete</span>(<span class="parameter">trie</span> : <a href="#type.Trie"><span class="type">Trie</span></a>, <span class="parameter">key</span> : <a href="#type.Key"><span class="type">Key</span></a>) : <a href="#type.Trie"><span class="type">Trie</span></a></code></h4><p><p>Delete a key from a trie</p>
</p></div><div class="declaration"><h4 class="function" id="deleteWithDB"><code><span class="keyword">public func </span><span class="fnname">deleteWithDB</span>(<br/>  <span class="parameter">trie</span> : <a href="#type.Trie"><span class="type">Trie</span></a>, <br/>  <span class="parameter">key</span> : <a href="#type.Key"><span class="type">Key</span></a>, <br/>  <span class="parameter">db</span> : <a href="#type.DB"><span class="type">DB</span></a><br/>) : <a href="#type.Result"><span class="type">Result</span></a>&lt;<a href="#type.Trie"><span class="type">Trie</span></a>, <span class="type">Text</span>&gt;</code></h4><p><p>Delete a key from a trie</p>
</p></div><div class="declaration"><h4 class="function" id="put"><code><span class="keyword">public func </span><span class="fnname">put</span>(<br/>  <span class="parameter">trie</span> : <a href="#type.Trie"><span class="type">Trie</span></a>, <br/>  <span class="parameter">key</span> : <a href="#type.Key"><span class="type">Key</span></a>, <br/>  <span class="parameter">value</span> : <a href="#type.Value"><span class="type">Value</span></a><br/>) : <a href="#type.Trie"><span class="type">Trie</span></a></code></h4><p><p>Add a value into a trie</p>
</p></div><div class="declaration"><h4 class="function" id="createLeaf"><code><span class="keyword">public func </span><span class="fnname">createLeaf</span>(<span class="parameter">key</span> : <a href="#type.Key"><span class="type">Key</span></a>, <span class="parameter">value</span> : <a href="#type.Value"><span class="type">Value</span></a>) : <a href="#type.Node"><span class="type">Node</span></a></code></h4><p><p>Create a leaf node</p>
</p></div><div class="declaration"><h4 class="function" id="get"><code><span class="keyword">public func </span><span class="fnname">get</span>(<span class="parameter">trie</span> : <a href="#type.Trie"><span class="type">Trie</span></a>, <span class="parameter">key</span> : <a href="#type.Key"><span class="type">Key</span></a>) : ?<a href="#type.Value"><span class="type">Value</span></a></code></h4><p><p>Get the value for a specific key</p>
</p></div><div class="declaration"><h4 class="function" id="getWithDB"><code><span class="keyword">public func </span><span class="fnname">getWithDB</span>(<br/>  <span class="parameter">trie</span> : <a href="#type.Trie"><span class="type">Trie</span></a>, <br/>  <span class="parameter">key</span> : <a href="#type.Key"><span class="type">Key</span></a>, <br/>  <span class="parameter">db</span> : <a href="#type.DB"><span class="type">DB</span></a><br/>) : <a href="#type.Result"><span class="type">Result</span></a>&lt;?<a href="#type.Value"><span class="type">Value</span></a>, <span class="type">Text</span>&gt;</code></h4><p><p>Get the value for a specific key</p>
</p></div><div class="declaration"><h4 class="function" id="nodeValue"><code><span class="keyword">public func </span><span class="fnname">nodeValue</span>(<span class="parameter">node</span> : <a href="#type.Node"><span class="type">Node</span></a>) : ?<a href="#type.Value"><span class="type">Value</span></a></code></h4><p><p>return the value of a node or null if no value is set</p>
</p></div><div class="declaration"><h4 class="function" id="nodeHash"><code><span class="keyword">public func </span><span class="fnname">nodeHash</span>(<span class="parameter">node</span> : <a href="#type.Node"><span class="type">Node</span></a>) : <a href="#type.Hash"><span class="type">Hash</span></a></code></h4><p><p>Function <code>H(x)</code> where <code>x</code> is <code>RLP(node)</code> and <code>H(x) = keccak256(x) if len(x) &gt;= 32 else x</code></p>
</p></div><div class="declaration"><h4 class="function" id="nodeSerialize"><code><span class="keyword">public func </span><span class="fnname">nodeSerialize</span>(<span class="parameter">node</span> : <a href="#type.Node"><span class="type">Node</span></a>) : [<span class="type">Nat8</span>]</code></h4><p></p></div><div class="declaration"><h4 class="function" id="rootHash"><code><span class="keyword">public func </span><span class="fnname">rootHash</span>(<span class="parameter">trie</span> : <a href="#type.Trie"><span class="type">Trie</span></a>) : <a href="#type.Hash"><span class="type">Hash</span></a></code></h4><p></p></div><div class="declaration"><h4 class="function" id="hashHex"><code><span class="keyword">public func </span><span class="fnname">hashHex</span>(<span class="parameter">trie</span> : <a href="#type.Trie"><span class="type">Trie</span></a>) : <span class="type">Text</span></code></h4><p></p></div><div class="declaration"><h4 class="type-declaration" id="type.Path"><span class="keyword">type </span><span class="type">Path</span> = { node : <a href="#type.Node"><span class="type">Node</span></a>; stack : <a href="#type.List"><span class="type">List</span></a>&lt;(<a href="#type.Key"><span class="type">Key</span></a>, <a href="#type.Node"><span class="type">Node</span></a>)&gt;; remaining : <a href="#type.Key"><span class="type">Key</span></a>; mismatch : <a href="#type.Node"><span class="type">Node</span></a> }</h4><p></p></div><div class="declaration"><h4 class="function" id="findPath"><code><span class="keyword">public func </span><span class="fnname">findPath</span>(<br/>  <span class="parameter">node</span> : <a href="#type.Node"><span class="type">Node</span></a>, <br/>  <span class="parameter">key</span> : <a href="#type.Key"><span class="type">Key</span></a>, <br/>  <span class="parameter">stack</span> : <a href="#type.List"><span class="type">List</span></a>&lt;(<a href="#type.Key"><span class="type">Key</span></a>, <a href="#type.Node"><span class="type">Node</span></a>)&gt;<br/>) : <a href="#type.Path"><span class="type">Path</span></a></code></h4><p><p>Find the a path in a node and return the path to get there.
If no node was found at the given key, the part that exists will be
returned as <code>stack</code> and the rest of the key will be returned as <code>remaining</code>.</p>
</p></div><div class="declaration"><h4 class="function" id="findPathWithDB"><code><span class="keyword">public func </span><span class="fnname">findPathWithDB</span>(<br/>  <span class="parameter">node</span> : <a href="#type.Node"><span class="type">Node</span></a>, <br/>  <span class="parameter">key</span> : <a href="#type.Key"><span class="type">Key</span></a>, <br/>  <span class="parameter">stack</span> : <a href="#type.List"><span class="type">List</span></a>&lt;(<a href="#type.Key"><span class="type">Key</span></a>, <a href="#type.Node"><span class="type">Node</span></a>)&gt;, <br/>  <span class="parameter">db</span> : <a href="#type.DB"><span class="type">DB</span></a><br/>) : <a href="#type.Path"><span class="type">Path</span></a></code></h4><p></p></div><div class="declaration"><h4 class="function" id="toIter"><code><span class="keyword">public func </span><span class="fnname">toIter</span>(<span class="parameter">trie</span> : <a href="#type.Trie"><span class="type">Trie</span></a>) : <span class="type">Iter.Iter</span>&lt;(<a href="#type.Key"><span class="type">Key</span></a>, <a href="#type.Value"><span class="type">Value</span></a>)&gt;</code></h4><p></p></div><div class="declaration"><h4 class="function" id="isEmpty"><code><span class="keyword">public func </span><span class="fnname">isEmpty</span>(<span class="parameter">trie</span> : <a href="#type.Trie"><span class="type">Trie</span></a>) : <span class="type">Bool</span></code></h4><p></p></div><div class="declaration"><h4 class="function" id="nodeEqual"><code><span class="keyword">public func </span><span class="fnname">nodeEqual</span>(<span class="parameter">a</span> : <a href="#type.Node"><span class="type">Node</span></a>, <span class="parameter">b</span> : <a href="#type.Node"><span class="type">Node</span></a>) : <span class="type">Bool</span></code></h4><p></p></div><div class="declaration"><h4 class="function" id="equal"><code><span class="keyword">public func </span><span class="fnname">equal</span>(<span class="parameter">a</span> : <a href="#type.Trie"><span class="type">Trie</span></a>, <span class="parameter">b</span> : <a href="#type.Trie"><span class="type">Trie</span></a>) : <span class="type">Bool</span></code></h4><p></p></div><div class="declaration"><h4 class="function" id="nodeToText"><code><span class="keyword">public func </span><span class="fnname">nodeToText</span>(<span class="parameter">node</span> : <a href="#type.Node"><span class="type">Node</span></a>) : <span class="type">Text</span></code></h4><p></p></div><div class="declaration"><h4 class="function" id="pathToText"><code><span class="keyword">public func </span><span class="fnname">pathToText</span>(<span class="parameter">path</span> : <a href="#type.Path"><span class="type">Path</span></a>) : <span class="type">Text</span></code></h4><p></p></div><div class="declaration"><h4 class="function" id="valueToText"><code><span class="keyword">public func </span><span class="fnname">valueToText</span>(<span class="parameter">value</span> : <a href="#type.Value"><span class="type">Value</span></a>) : <span class="type">Text</span></code></h4><p></p></div><div class="declaration"><h4 class="type-declaration" id="type.DB"><span class="keyword">type </span><span class="type">DB</span> = { put : (<a href="#type.Hash"><span class="type">Hash</span></a>, <a href="#type.Node"><span class="type">Node</span></a>) -&gt; (); get : <a href="#type.Hash"><span class="type">Hash</span></a> -&gt; ?<a href="#type.Node"><span class="type">Node</span></a> }</h4><p></p></div><div class="declaration"><h4 class="function" id="putWithDB"><code><span class="keyword">public func </span><span class="fnname">putWithDB</span>(<br/>  <span class="parameter">trie</span> : <a href="#type.Trie"><span class="type">Trie</span></a>, <br/>  <span class="parameter">key</span> : <a href="#type.Key"><span class="type">Key</span></a>, <br/>  <span class="parameter">value</span> : <a href="#type.Value"><span class="type">Value</span></a>, <br/>  <span class="parameter">db</span> : <a href="#type.DB"><span class="type">DB</span></a><br/>) : <a href="#type.Result"><span class="type">Result</span></a>&lt;<a href="#type.Trie"><span class="type">Trie</span></a>, <span class="type">Text</span>&gt;</code></h4><p></p></div></div></body></html>